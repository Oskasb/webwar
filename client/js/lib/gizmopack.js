webpackJsonp([8],{0:function(a,b,c){a.exports=c(290)},290:function(a,b,c){if(a.exports={Gizmo:c(291),GizmoRenderSystem:c(292),GlobalRotationGizmo:c(298),GlobalTranslationGizmo:c(295),RotationGizmo:c(296),ScaleGizmo:c(299),TranslationGizmo:c(293)},"undefined"!=typeof window)for(var d in a.exports)window.goo[d]=a.exports[d]},291:function(a,b,c){function d(a){this.name=a,this._plane=new j,this._line=new k,this._activeHandle=null,this.visible=!1,this.transform=new i,this.renderables=[],this.onChange=null}var e=c(14),f=c(31),g=c(30),h=c(123),i=c(41),j=c(121),k=c(8),l=c(120),m=c(9);d.handleStore=[],d.registerHandle=function(a){var b=d.handleStore.length+16e3;return d.handleStore.push(a),b},d.getHandle=function(a){return 16e3>a?null:d.handleStore[a-16e3]},d.prototype.getRenderable=function(a){for(var b=0;b<this.renderables.length;b++){var c=this.renderables[b];if(c.id===a)return c}},d.prototype.setSnap=function(a){this._snap=a},d.prototype.activate=function(a){this._activeHandle=a.data,this._activeRenderable=this.getRenderable(a.id),this._activeRenderable.materials[0].uniforms.color=[1,1,0]},d.prototype.deactivate=function(){if(this._activeRenderable){var a=this._activeRenderable.originalColor;this._activeRenderable.materials[0].uniforms.color=a.slice()}},d.prototype.copyTransform=function(a){this.transform.setIdentity(),a&&(a.matrix.getTranslation(this.transform.translation),this.transform.rotation.copy(a.rotation),this.updateTransforms())},d.prototype._postProcess=function(a){this.updateTransforms(),this.onChange instanceof Function&&this.onChange(a)},d.prototype.updateRenderableTransform=function(a){a.transform.matrix.mul2(this.transform.matrix,a.transform.matrix)};var n=1/60;d.prototype.updateTransforms=function(){if(h.mainCamera){var a,b=h.mainCamera;if(b.projectionMode===l.Perspective){var c=b.translation.distance(this.transform.translation);a=c*n,a*=2*Math.tan(b.fov*m.DEG_TO_RAD/2)}else a=(b._frustumTop-b._frustumBottom)/30;this.transform.scale.setDirect(a,a,a)}this.transform.update();for(var d=this.renderables.length-1;d>=0;d--)this.renderables[d].transform.update(),this.updateRenderableTransform(this.renderables[d])},function(){var a=new k,b=new k,c=new k,e=new k,f=new k,g=new k,i=new k,j=new k;d.prototype._setPlane=function(){var d=this._plane.normal;if("Plane"===this._activeHandle.type)d.copy([k.UNIT_X,k.UNIT_Y,k.UNIT_Z][this._activeHandle.axis]),d.applyPostVector(this.transform.matrix),d.normalize(),a.copy(k.ZERO),a.applyPostPoint(this.transform.matrix),this._plane.constant=a.dot(d);else{switch(a.copy(k.ZERO),a.applyPostPoint(this.transform.matrix),b.copy(k.UNIT_X),b.applyPostPoint(this.transform.matrix),c.copy(k.UNIT_Y),c.applyPostPoint(this.transform.matrix),e.copy(k.UNIT_Z),e.applyPostPoint(this.transform.matrix),h.mainCamera.getScreenCoordinates(a,1,1,f),h.mainCamera.getScreenCoordinates(b,1,1,g),g.sub(f),h.mainCamera.getScreenCoordinates(c,1,1,i),i.sub(f),h.mainCamera.getScreenCoordinates(e,1,1,j),j.sub(f),this._activeHandle.axis){case 0:d.copy(i.cross(g).length()>j.cross(g).length()?e:c);break;case 1:d.copy(j.cross(i).length()>g.cross(i).length()?b:e);break;case 2:d.copy(g.cross(j).length()>i.cross(j).length()?c:b)}d.sub(a).normalize(),this._plane.constant=a.dot(d)}}}(),d.prototype._setLine=function(){this._line.copy([k.UNIT_X,k.UNIT_Y,k.UNIT_Z][this._activeHandle.axis]),this._line.applyPostVector(this.transform.matrix),this._line.normalize()},d.prototype.addRenderable=function(a){a.originalColor=a.materials[0].uniforms.color,this.renderables.push(a)},d.buildMaterialForAxis=function(a,b){var c=new g(p,a+"Material");return c.uniforms.color=o[a].slice(),void 0!==b&&1>b&&(c.blendState.blending="TransparencyBlending",c.uniforms.opacity=b,c.renderQueue=3e3),c.cullState.enabled=!1,c};var o=[[1,.1,.3],[.3,1,.2],[.2,.3,1],[.8,.8,.8]],p={attributes:{vertexPosition:e.POSITION,vertexNormal:e.NORMAL},uniforms:{viewProjectionMatrix:f.VIEW_PROJECTION_MATRIX,worldMatrix:f.WORLD_MATRIX,color:[1,1,1],opacity:1},vshader:["attribute vec3 vertexPosition;","attribute vec3 vertexNormal;","uniform mat4 viewProjectionMatrix;","uniform mat4 worldMatrix;","varying vec3 normal;","varying vec3 viewPosition;","void main(void) {"," vec4 worldPos = worldMatrix * vec4(vertexPosition, 1.0);"," gl_Position = viewProjectionMatrix * worldPos;"," normal = vertexNormal;","}"].join("\n"),fshader:["varying vec3 normal;","uniform vec3 color;","uniform float opacity;","void main(void)","{"," vec3 N = normalize(normal);"," vec4 final_color = vec4(color, 1.0);"," vec3 light = vec3(1.0, 1.0, 10.0);"," float dotProduct = dot(N, normalize(light));"," float diffuse = max(dotProduct, 0.0);"," final_color.rgb *= (0.5 * diffuse + 0.5);"," final_color.a = opacity;"," gl_FragColor = final_color;","}"].join("\n")};a.exports=d},292:function(a,b,c){function d(a){e.call(this,"GizmoRenderSystem",null),this.renderables=[],this.camera=null,this.gizmos=[new o,new p,new q,new r,new s],this.active=!1,this.nextGizmo=null,this.setupCallbacks(a),this.activeGizmo=null,this.viewportWidth=0,this.viewportHeight=0,this.domElement=null,this.pickingMaterial=g.createEmptyMaterial(t,"pickingMaterial"),this.pickingMaterial.blendState={blending:"NoBlending",blendEquation:"AddEquation",blendSrc:"SrcAlphaFactor",blendDst:"OneMinusSrcAlphaFactor"},this._devicePixelRatio=1,this._mouseState=new k,this._oldMouseState=new k,this._dirty=!1,this._mouseMove=function(a){if(this.activeGizmo){var b=void 0!==a.offsetX?a.offsetX:a.layerX,c=void 0!==a.offsetY?a.offsetY:a.layerY;this._mouseState.setDirect(b/(this.viewportWidth/this._devicePixelRatio),c/(this.viewportHeight/this._devicePixelRatio)),this._dirty=!0}}.bind(this),f.addListener("goo.setCurrentCamera",function(a){this.camera=a.camera}.bind(this))}var e=c(42),f=c(44),g=c(30),h=c(47),i=c(24),j=c(33),k=c(19),l=c(14),m=c(31),n=c(291),o=c(293),p=c(295),q=c(296),r=c(298),s=c(299);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.activate=function(a,b,c){this.active=!0;var d=n.getHandle(a);d&&this.activeGizmo&&(this._oldMouseState.setDirect(b/(this.viewportWidth/this._devicePixelRatio),c/(this.viewportHeight/this._devicePixelRatio)),this.activeGizmo.activate({id:a,data:d,x:b/(this.viewportWidth/this._devicePixelRatio),y:c/(this.viewportHeight/this._devicePixelRatio)}),this.domElement.addEventListener("mousemove",this._mouseMove))},d.prototype.deactivate=function(){this.activeGizmo.deactivate(),this.active=!1,this.domElement.removeEventListener("mousemove",this._mouseMove),null!==this.nextGizmo&&(this.setActiveGizmo(this.nextGizmo),this.nextGizmo=null)},d.prototype.getGizmo=function(a){return this.gizmos[a]},d.prototype.show=function(a){this.entity=a,this.activeGizmo&&(this.entity?this.showGizmo(this.activeGizmo):this.hideGizmo(this.activeGizmo))},d.prototype.showGizmo=function(a){a.copyTransform(this.entity.transformComponent.sync().worldTransform),a.visible||(this.renderables=a.renderables,a.visible=!0)},d.prototype.hideGizmo=function(a){a.visible&&(this.renderables=[],a.visible=!1)},d.prototype.setActiveGizmo=function(a){return this.active?void(this.nextGizmo=a):(this.activeGizmo&&this.hideGizmo(this.activeGizmo),this.activeGizmo=this.gizmos[a]||null,void(this.activeGizmo&&this.entity&&this.showGizmo(this.activeGizmo)))},d.prototype.setSnap=function(a){this.activeGizmo&&this.activeGizmo.setSnap(a)},d.prototype.setupCallbacks=function(a){if(a&&5===a.length)return this.gizmos[0].onChange=a[0],this.gizmos[1].onChange=a[1],this.gizmos[2].onChange=a[2],this.gizmos[3].onChange=a[3],void(this.gizmos[4].onChange=a[4]);var b=new i,c=new j,d=function(a){if(this.entity){var b=this.entity.transformComponent.sync().transform.translation;b.copy(a),this.entity.transformComponent.parent&&(c.copy(this.entity.transformComponent.parent.sync().worldTransform.matrix),c.invert(),b.applyPostPoint(c)),this.entity.transformComponent.setUpdated()}}.bind(this);this.gizmos[0].onChange=d,this.gizmos[1].onChange=d;var e=function(a){this.entity&&(this.entity.transformComponent.sync().transform.rotation.copy(a),this.entity.transformComponent.parent&&(b.copy(this.entity.transformComponent.parent.sync().worldTransform.rotation),b.invert(),this.entity.transformComponent.transform.rotation.mul(b)),this.entity.transformComponent.setUpdated())}.bind(this);this.gizmos[2].onChange=e,this.gizmos[3].onChange=e,this.gizmos[4].onChange=function(a){if(this.entity){var b=this.entity.transformComponent.sync().transform.scale;b.copy(a),this.entity.transformComponent.parent&&b.div(this.entity.transformComponent.parent.sync().worldTransform.scale),this.entity.transformComponent.setUpdated()}}.bind(this)},d.prototype.inserted=function(){},d.prototype.deleted=function(){},d.prototype.process=function(){this.activeGizmo&&this._dirty&&(this.activeGizmo.process(this._mouseState,this._oldMouseState),this._oldMouseState.copy(this._mouseState),this._dirty=!1)},d.prototype.render=function(a){this.activeGizmo&&this.activeGizmo.updateTransforms(),a.checkResize(this.camera),this._devicePixelRatio=a._useDevicePixelRatio&&window.devicePixelRatio?window.devicePixelRatio/a.svg.currentScale:1,this.domElement||(this.domElement=a.domElement),this.viewportHeight=a.viewportHeight,this.viewportWidth=a.viewportWidth,this.camera&&a.render(this.renderables,this.camera,this.lights,null,{color:!1,stencil:!0,depth:!0},this.overrideMaterials)},d.prototype.invalidateHandles=function(a){a.invalidateMaterial(this.pickingMaterial),this.gizmos.forEach(function(b){b.renderables.forEach(function(b){b.materials.forEach(function(b){a.invalidateMaterial(b)}),a.invalidateMeshData(b.meshData)})})},d.prototype.renderToPick=function(a,b){for(var c=0;c<this.renderables.length;c++){var d=this.renderables[c];void 0!==d.thickness&&(d.materials[0].uniforms.thickness=d.thickness)}a.renderToPick(this.renderables,this.camera,{color:!1,stencil:!0,depth:!0},b,void 0,void 0,void 0,this.pickingMaterial);for(var c=0;c<this.renderables.length;c++){var d=this.renderables[c];d.thickness&&(d.materials[0].uniforms.thickness=0)}};var t={attributes:{vertexPosition:l.POSITION,vertexNormal:l.NORMAL},processors:[function(a,b){var c=b.meshData.attributeMap;a.defines=a.defines||{};for(var d in c)a.setDefine(d,!0)}],uniforms:{viewMatrix:m.VIEW_MATRIX,projectionMatrix:m.PROJECTION_MATRIX,worldMatrix:m.WORLD_MATRIX,cameraFar:m.FAR_PLANE,thickness:0,id:function(a){return a.renderable.id+1}},vshader:["attribute vec3 vertexPosition;","#ifdef NORMAL","attribute vec3 vertexNormal;","#endif","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 worldMatrix;","uniform float cameraFar;","uniform float thickness;","varying float depth;","void main() {","  #ifdef NORMAL","  vec4 mvPosition = viewMatrix * worldMatrix * vec4( vertexPosition + vertexNormal * thickness, 1.0 );","  #else","  vec4 mvPosition = viewMatrix * worldMatrix * vec4( vertexPosition, 1.0 );","  #endif","  depth = length(mvPosition.xyz) / cameraFar;","  gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fshader:["uniform float id;","varying float depth;",h.methods.packDepth16,"void main() {","  vec2 packedId = vec2(floor(id/255.0), mod(id, 255.0)) * vec2(1.0/255.0);","  vec2 packedDepth = packDepth16(depth);","  gl_FragColor = vec4(packedId, packedDepth);","}"].join("\n")};a.exports=d},293:function(a,b,c){function d(){h.call(this,"TranslationGizmo"),this.realTranslation=new n,this._snap=!1,this.compileRenderables()}function e(a){a.x=Math.round(a.x),a.y=Math.round(a.y),a.z=Math.round(a.z)}function f(a,b,c){var d=new m,e=new m,f=1;return e.scale.setDirect(f,f,f),2===c?e.translation.setDirect(f,f,0):0===c?(e.translation.setDirect(0,f,f),e.setRotationXYZ(0,Math.PI/2,0),d.setRotationXYZ(0,Math.PI/2,0)):1===c&&(e.translation.setDirect(f,0,f),e.setRotationXYZ(Math.PI/2,0,0),d.setRotationXYZ(3*Math.PI/2,0,0)),[{meshData:a,materials:[h.buildMaterialForAxis(c)],transform:d,id:h.registerHandle({type:"Axis",axis:c}),thickness:.6},{meshData:b,materials:[h.buildMaterialForAxis(c,.6)],transform:e,id:h.registerHandle({type:"Plane",axis:c})}]}function g(){var a=new j,b=new k(32,.6,2.3),c=new k(32,.6),d=new i(i.defaultMap([i.POSITION]),2,2);d.getAttributeBuffer(i.POSITION).set([0,0,0,0,0,7]),d.getIndexBuffer().set([0,1]),d.indexLengths=null,d.indexModes=["Lines"];var e=new m;e.translation.setDirect(0,0,7),e.update(),a.addMeshData(b,e),e.setRotationXYZ(0,Math.PI,0),e.update(),a.addMeshData(c,e);var e=new m;e.update(),a.addMeshData(d,e);var f=a.build()[0];return f}var h=c(291),i=c(14),j=c(112),k=c(294),l=c(28),m=c(41),n=c(8),o=c(122),p=c(123);d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.prototype.activate=function(a){h.prototype.activate.call(this,a),this._setPlane(),"Axis"===this._activeHandle.type&&this._setLine(),this.realTranslation.copy(this.transform.translation)},d.prototype.copyTransform=function(){h.prototype.copyTransform.apply(this,arguments)},d.prototype.setSnap=function(a){this._snap=a},function(){var a=new o,b=new o;d.prototype.process=function(c,d){p.mainCamera.getPickRay(d.x,d.y,1,1,a),p.mainCamera.getPickRay(c.x,c.y,1,1,b),"Plane"===this._activeHandle.type?this._moveOnPlane(a,b,this._plane):"Axis"===this._activeHandle.type&&this._moveOnLine(a,b,this._plane,this._line),this._postProcess(this.transform.translation)}}(),d.prototype._addTranslation=function(a){this.realTranslation.add(a),this.transform.translation.copy(this.realTranslation),this._snap&&e(this.transform.translation)},function(){var a=new n,b=new n,c=new n;d.prototype._moveOnPlane=function(d,e,f){f.rayIntersect(d,a,!0),f.rayIntersect(e,b,!0),c.copy(b).sub(a),this._addTranslation(c)}}(),function(){var a=new n,b=new n,c=new n;d.prototype._moveOnLine=function(d,e,f,g){f.rayIntersect(d,a,!0),f.rayIntersect(e,b,!0),c.copy(b).sub(a);var h=c.dot(g);c.copy(g).scale(h),this._addTranslation(c)}}(),d.prototype.compileRenderables=function(){var a=g(),b=new l(2,2);f(a,b,0).forEach(this.addRenderable,this),f(a,b,1).forEach(this.addRenderable,this),f(a,b,2).forEach(this.addRenderable,this)},a.exports=d},295:function(a,b,c){function d(){e.call(this,"GlobalTranslationGizmo"),this.realTranslation=new f,this._snap=!1,this.compileRenderables()}var e=c(291),f=c(8),g=c(293);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.activate=g.prototype.activate,d.prototype.process=g.prototype.process,d.prototype.copyTransform=function(a){e.prototype.copyTransform.call(this,a),this.transform.rotation.setIdentity(),this.updateTransforms()},d.prototype.setSnap=g.prototype.setSnap,d.prototype._addTranslation=g.prototype._addTranslation,d.prototype._moveOnPlane=g.prototype._moveOnPlane,d.prototype._moveOnLine=g.prototype._moveOnLine,d.prototype.compileRenderables=g.prototype.compileRenderables,a.exports=d},296:function(a,b,c){function d(){h.call(this,"RotationGizmo"),this._rotation=new l,this._direction=new k,this.snap=!1,this._accumulatedRotation=new k,this._oldAngle=new k,this.compileRenderables()}function e(a,b){return function(c){var d=c%a;return d+=0>d?a:0,b>d?c-d:d>a-b?c+a-d:c}}function f(a){var b=new m;return b.scale.setDirect(1.2,1.2,1.2),{meshData:a,materials:[h.buildMaterialForAxis(3,.6)],transform:new m,id:h.registerHandle({type:"Rotate",axis:3})}}function g(a,b){var c=new m;return c.scale.setDirect(1.7,1.7,1.7),0===b?c.setRotationXYZ(0,p.HALF_PI,0):1===b&&c.setRotationXYZ(p.HALF_PI,0,0),{meshData:a,materials:[h.buildMaterialForAxis(b)],transform:c,id:h.registerHandle({type:"Rotate",axis:b}),thickness:.35}}var h=c(291),i=c(29),j=c(297),k=c(8),l=c(24),m=c(41),n=c(123),o=c(122),p=c(9);d.prototype=Object.create(h.prototype),d.prototype.constructor=d;var q=4;!function(){var a=new k,b=new k,c=new k,e=new k,f=new o,g=new k;d.prototype.activate=function(d){if(h.prototype.activate.call(this,d),this._activeHandle.axis<3){e.copy([k.UNIT_X,k.UNIT_Y,k.UNIT_Z][this._activeHandle.axis]),e.applyPost(this.transform.rotation),a.copy(k.ZERO),a.applyPostPoint(this.transform.matrix),n.mainCamera.getPickRay(d.x,d.y,1,1,f),b.copy(f.origin).sub(a);var i=.9*b.length();b.copy(f.direction).scale(i).add(f.origin),c.copy(b).sub(a),g.copy(e).cross(c),c.copy(g),c.add(b),n.mainCamera.getScreenCoordinates(c,1,1,this._direction),this._direction.subDirect(d.x,d.y,0),this._direction.z=0,this._direction.normalize()}}}(),d.prototype.process=function(a,b){var c=a.clone().sub(b);3===this._activeHandle.axis?this._rotateOnScreen(c):this._rotateOnAxis(c),this._postProcess(this.transform.rotation)},function(){var a=new l,b=new l;d.prototype._rotateOnScreen=function(c){this._rotation.setIdentity(),this._rotation.rotateY(c.x*q),this._rotation.rotateX(c.y*q);var d=n.mainCamera.getViewMatrix();a.copyMatrix4(d),b.set(a).invert(),b.mul(this._rotation),b.mul(a),this.transform.rotation.mul2(b,this.transform.rotation)}}();var r=e(Math.PI/4,Math.PI/16),s=function(a){return a};d.prototype._applyRotation=function(){this.transform.rotation.mul2(this.transform.rotation,this._rotation)},d.prototype._rotateOnAxis=function(a){this._rotation.setIdentity();var b=a.x*this._direction.x+a.y*this._direction.y;b*=q;var c,d=this._snap?r:s;switch(this._activeHandle.axis){case 0:this._accumulatedRotation.x+=b,c=d(this._accumulatedRotation.x),this._rotation.rotateX(c-this._oldAngle.x),this._oldAngle.x=c;break;case 1:this._accumulatedRotation.y+=b,c=d(this._accumulatedRotation.y),this._rotation.rotateY(c-this._oldAngle.y),this._oldAngle.y=c;break;case 2:this._accumulatedRotation.z+=b,c=d(this._accumulatedRotation.z),this._rotation.rotateZ(c-this._oldAngle.z),this._oldAngle.z=c}this._applyRotation()},d.prototype.compileRenderables=function(){var a=new i(32,32,1.1),b=new j(64,8,.1,2.5);this.addRenderable(f(a)),this.addRenderable(g(b,0)),this.addRenderable(g(b,1)),this.addRenderable(g(b,2))},a.exports=d},298:function(a,b,c){function d(){e.call(this,"GlobalRotationGizmo"),this._rotation=new h,this._direction=new g,this.snap=!1,this._accumulatedRotation=new g,this._oldAngle=new g,this.compileRenderables()}var e=c(291),f=c(296),g=c(8),h=c(24),i=c(41),j=c(123),k=c(122);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,function(){var a=new g,b=new g,c=new g,f=new g,h=new k,i=new g;d.prototype.activate=function(d){if(e.prototype.activate.call(this,d),this._activeHandle.axis<3){f.copy([g.UNIT_X,g.UNIT_Y,g.UNIT_Z][this._activeHandle.axis]),a.copy(g.ZERO),a.applyPostPoint(this.transform.matrix),j.mainCamera.getPickRay(d.x,d.y,1,1,h),b.copy(h.origin).sub(a);var k=.9*b.length();b.copy(h.direction).scale(k).add(h.origin),c.copy(b).sub(a),i.copy(f).cross(c),c.copy(i),c.add(b),j.mainCamera.getScreenCoordinates(c,1,1,this._direction),this._direction.subDirect(d.x,d.y,0),this._direction.z=0,this._direction.normalize()}}}(),d.prototype.process=f.prototype.process,d.prototype._rotateOnScreen=f.prototype._rotateOnScreen,d.prototype._applyRotation=function(){this.transform.rotation.mul2(this._rotation,this.transform.rotation)},d.prototype._rotateOnAxis=f.prototype._rotateOnAxis,function(){var a=new i;d.prototype.updateRenderableTransform=function(b){a.copy(this.transform),a.rotation.setIdentity(),a.update(),b.transform.matrix.mul2(a.matrix,b.transform.matrix)}}(),d.prototype.compileRenderables=f.prototype.compileRenderables,a.exports=d},299:function(a,b,c){function d(a){h.call(this,"ScaleGizmo",a),this._transformScale=new n(1,1,1),this.compileRenderables()}function e(a){return{meshData:a,materials:[h.buildMaterialForAxis(3)],transform:new l,id:h.registerHandle({type:"Scale",axis:3})}}function f(a,b){var c=new l;return 0===b?c.setRotationXYZ(0,Math.PI/2,0):1===b&&c.setRotationXYZ(3*Math.PI/2,0,0),{meshData:a,materials:[h.buildMaterialForAxis(b)],transform:c,id:h.registerHandle({type:"Scale",axis:b})}}function g(){var a=new j,b=new k,c=new i(i.defaultMap([i.POSITION]),2,2);c.getAttributeBuffer(i.POSITION).set([0,0,0,0,0,1]),c.getIndexBuffer().set([0,1]),c.indexLengths=null,c.indexModes=["Lines"];var d=new l;d.translation.setDirect(0,0,8),d.update(),a.addMeshData(b,d);var d=new l;d.scale.setDirect(1,1,8),d.update(),a.addMeshData(c,d);var e=a.build()[0];return e}var h=c(291),i=c(14),j=c(112),k=c(27),l=c(41),m=c(123),n=c(8),o=c(122),p=c(9);d.prototype=Object.create(h.prototype),d.prototype.constructor=d;var q=1;d.prototype.activate=function(a){h.prototype.activate.call(this,a),3!==this._activeHandle.axis&&(this._setPlane(),this._setLine())},d.prototype.copyTransform=function(a){h.prototype.copyTransform.call(this,a),this._transformScale.copy(a.scale)},d.prototype.process=function(a,b){3===this._activeHandle.axis?this._scaleUniform(a,b):this._scaleNonUniform(a,b),this._postProcess(this._transformScale)},d.prototype._scaleUniform=function(a,b){var c=Math.pow(1+a.x+b.y-b.x-a.y,q),d=m.mainCamera.translation.distance(this.transform.translation);c+=d/2e5*p.sign(c-1),this._transformScale.scale(c)},function(){var a=new o,b=new o,c=new n,e=new n,f=new n,g=["x","y","z"];d.prototype._scaleNonUniform=function(d,h){m.mainCamera.getPickRay(h.x,h.y,1,1,a),m.mainCamera.getPickRay(d.x,d.y,1,1,b),this._plane.rayIntersect(a,c),this._plane.rayIntersect(b,e),f.copy(e).sub(c),f.div(this.transform.scale).scale(.07);var i=f.dot(this._line),j=Math.pow(1+i,q);this._transformScale[g[this._activeHandle.axis]]*=j}}(),d.prototype.compileRenderables=function(){var a=new k(1.4,1.4,1.4),b=g();this.addRenderable(e(a)),this.addRenderable(f(b,0)),this.addRenderable(f(b,1)),this.addRenderable(f(b,2))},a.exports=d}});