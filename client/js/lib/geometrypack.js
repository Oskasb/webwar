webpackJsonp([7],{0:function(a,b,c){a.exports=c(281)},281:function(a,b,c){if(a.exports={FilledPolygon:c(282),PolyLine:c(283),RegularPolygon:c(285),Surface:c(284),TextComponent:c(286),TextComponentHandler:c(288),TextMeshGenerator:c(287),Triangle:c(289)},"undefined"!=typeof window)for(var d in a.exports)window.goo[d]=a.exports[d]},282:function(a,b,c){function d(a,b){this.verts=a,this.indices=b?b:e(a);var c=i.defaultMap([i.POSITION,i.NORMAL,i.TEXCOORD0]);i.call(this,c,this.verts.length/3,this.indices.length),this.rebuild()}function e(a){var b=a.length/3;if(3>b)return[];for(var c=[],d=[],e=0;b>e;e++)d.push(e);for(var e=0,h=b;h>3;){var i=d[(e+0)%h],j=d[(e+1)%h],k=d[(e+2)%h],l=a[3*i],m=a[3*i+1],n=a[3*j],o=a[3*j+1],p=a[3*k],q=a[3*k+1],r=!1;if(g(l,m,n,o,p,q)){r=!0;for(var s=0;h>s;s++){var t=d[s];if(t!==i&&t!==j&&t!==k&&f(a[3*t],a[3*t+1],l,m,n,o,p,q)){r=!1;break}}}if(r)c.push(i,j,k),d.splice((e+1)%h,1),h--,e=0;else if(e++>3*h)break}return c.push(d[0],d[1],d[2]),c}function f(a,b,c,d,e,f,g,h){var i=g-c,j=h-d,k=e-c,l=f-d,m=a-c,n=b-d,o=i*i+j*j,p=i*k+j*l,q=i*m+j*n,r=k*k+l*l,s=k*m+l*n,t=1/(o*r-p*p),u=(r*q-p*s)*t,v=(o*s-p*q)*t;return u>=0&&v>=0&&1>u+v}function g(a,b,c,d,e,f){return(b-d)*(e-c)+(c-a)*(f-d)>=0}function h(a){for(var b=a[0],c=a[0],d=a[1],e=a[1],f=3;f<a.length;f+=3)b=b<a[f+0]?b:a[f+0],c=c>a[f+0]?c:a[f+0],d=d<a[f+1]?d:a[f+1],e=e>a[f+1]?e:a[f+1];return{minX:b,maxX:c,minY:d,maxY:e}}var i=c(14),j=c(9);d.prototype=Object.create(i.prototype),d.prototype.rebuild=function(){this.getAttributeBuffer(i.POSITION).set(this.verts);for(var a=[],b=0;b<this.indices.length;b+=3){var c=j.getTriangleNormal(this.verts[3*this.indices[b+0]+0],this.verts[3*this.indices[b+0]+1],this.verts[3*this.indices[b+0]+2],this.verts[3*this.indices[b+1]+0],this.verts[3*this.indices[b+1]+1],this.verts[3*this.indices[b+1]+2],this.verts[3*this.indices[b+2]+0],this.verts[3*this.indices[b+2]+1],this.verts[3*this.indices[b+2]+2]);a[3*this.indices[b+0]+0]=c[0],a[3*this.indices[b+0]+1]=c[1],a[3*this.indices[b+0]+2]=c[2],a[3*this.indices[b+1]+0]=c[0],a[3*this.indices[b+1]+1]=c[1],a[3*this.indices[b+1]+2]=c[2],a[3*this.indices[b+2]+0]=c[0],a[3*this.indices[b+2]+1]=c[1],a[3*this.indices[b+2]+2]=c[2]}this.getAttributeBuffer(i.NORMAL).set(a),this.getIndexBuffer().set(this.indices);for(var d=[],e=h(this.verts),f=e.maxX-e.minX,g=e.maxY-e.minY,b=0;b<this.verts.length;b+=3){var k=(this.verts[b+0]-e.minX)/f,l=(this.verts[b+1]-e.minY)/g;d.push(k,l)}return this.getAttributeBuffer(i.TEXCOORD0).set(d),this},a.exports=d},283:function(a,b,c){function d(a,b){this.verts=a,this.closed=!!b;var c=e.defaultMap([e.POSITION]);e.call(this,c,this.verts.length/3,this.verts.length/3),this.closed?this.indexModes=["LineLoop"]:this.indexModes=["LineStrip"],this.rebuild()}var e=c(14),f=c(284),g=c(24),h=c(8);d.prototype=Object.create(e.prototype),d.prototype.rebuild=function(){this.getAttributeBuffer(e.POSITION).set(this.verts);for(var a=[],b=this.verts.length/3,c=0;b>c;c++)a.push(c);return this.getIndexBuffer().set(a),this},d.prototype.mul=function(a){if(a instanceof d){for(var b=a.verts.length/3,c=[],e=0;e<this.verts.length;e+=3)for(var g=0;g<a.verts.length;g+=3)c.push(this.verts[e+0]+a.verts[g+0],this.verts[e+1]+a.verts[g+1],this.verts[e+2]+a.verts[g+2]);return new f(c,b)}},function(){function a(a,b,c,d){var e,f;b>=a.length/3-1?(e=b-1,f=b):(e=b,f=b+1);var g=new h(a[3*f+0]-a[3*e+0],a[3*f+1]-a[3*e+1],a[3*f+2]-a[3*e+2]);g.normalize(),d.lookAt(g,c)}var b=h.UNIT_Z;d.prototype.pipe=function(c,d){d=d||{};for(var e,i=c.verts.length/3,j=[],k=new h,l=h.UNIT_Y.clone(),m=new h,n=new g,o=new g,p=0;p<this.verts.length;p+=3){a(this.verts,p/3,l,n);var q=p/(this.verts.length-1);d.twist&&(o.fromAngles(0,0,d.twist(q)),n.mul(o)),e=d.scale?d.scale(q):1,k.copy(b),k.applyPost(n),m.copy(k).cross(l).normalize(),l.copy(m).cross(k);for(var r=0;r<c.verts.length;r+=3){var s=new h(c.verts[r+0],c.verts[r+1],c.verts[r+2]);s.applyPost(n),s.scale(e),s.addDirect(this.verts[p+0],this.verts[p+1],this.verts[p+2]),j.push(s.x,s.y,s.z)}}return new f(j,i)}}(),d.prototype.lathe=function(a){a=a||8;for(var b=2*Math.PI/a,c=[],d=0;d<this.verts.length;d+=3)for(var e=0,g=0;a>=e;e++,g+=b)c.push(Math.cos(g)*this.verts[d+0],this.verts[d+1],Math.sin(g)*this.verts[d+0]);return new f(c,a+1,!0)},d.prototype.concat=function(a,b){var c=this.verts.length-1;return this.verts[c-2]===a.verts[0]&&this.verts[c-1]===a.verts[1]&&this.verts[c-0]===a.verts[2]?new d(this.verts.slice(0,-3).concat(a.verts),b):new d(this.verts.concat(a.verts),b)},d.fromCubicBezier=function(a,b,c){if(12!==a.length)return void console.error("PolyLine.fromCubicBezier takes an array of exactly 12 coordinates");b=b||16,c=c||0;for(var e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=c;b>=l;l++){var m=l/b;f[0]=a[0]+(a[3]-a[0])*m,f[1]=a[1]+(a[4]-a[1])*m,f[2]=a[2]+(a[5]-a[2])*m,g[0]=a[3]+(a[6]-a[3])*m,g[1]=a[4]+(a[7]-a[4])*m,g[2]=a[5]+(a[8]-a[5])*m,h[0]=a[6]+(a[9]-a[6])*m,h[1]=a[7]+(a[10]-a[7])*m,h[2]=a[8]+(a[11]-a[8])*m,i[0]=f[0]+(g[0]-f[0])*m,i[1]=f[1]+(g[1]-f[1])*m,i[2]=f[2]+(g[2]-f[2])*m,j[0]=g[0]+(h[0]-g[0])*m,j[1]=g[1]+(h[1]-g[1])*m,j[2]=g[2]+(h[2]-g[2])*m,k[0]=i[0]+(j[0]-i[0])*m,k[1]=i[1]+(j[1]-i[1])*m,k[2]=i[2]+(j[2]-i[2])*m,e.push(k[0],k[1],k[2])}return e=a.slice(0,3).concat(e),new d(e)},d.fromQuadraticSpline=function(a,b,c){if(a.length%3!==0&&a.length/3%2!==0)return void console.error("Wrong number of coordinates supplied in first argument to PolyLine.fromQuadraticSpline");for(var e=[],f=0;f<a.length-6;f+=6){var g=a.slice(f,f+3),h=a.slice(f+3,f+6),i=a.slice(f+6,f+9);e.push.apply(e,[g[0],g[1],g[2],g[0]+2/3*(h[0]-g[0]),g[1]+2/3*(h[1]-g[1]),g[2]+2/3*(h[2]-g[2]),i[0]+2/3*(h[0]-i[0]),i[1]+2/3*(h[1]-i[1]),i[2]+2/3*(h[2]-i[2])])}return e.push.apply(e,a.slice(a.length-3,a.length)),d.fromCubicSpline(e,b,c)},d.fromCubicSpline=function(a,b,c){if(c){if(a.length%3!==0&&a.length/3%3!==0)return void console.error("Wrong number of coordinates supplied in first argument to PolyLine.fromCubicSpline");for(var e=a.length/3,f=e/3,g=d.fromCubicBezier(a.slice(0,12),b,1),h=1;f-1>h;h++){var i=d.fromCubicBezier(a.slice(3*h*3,3*h*3+12),b,1);g=g.concat(i)}var i=d.fromCubicBezier(a.slice(3*h*3,3*h*3+9).concat(a.slice(0,3)),b,1);return g=g.concat(i)}if(a.length%3!==0&&a.length/3%3!==1)return void console.error("Wrong number of coordinates supplied in first argument to PolyLine.fromCubicSpline");for(var e=a.length/3,f=(e-1)/3,g=d.fromCubicBezier(a.slice(0,12),b,1),h=1;f>h;h++){var i=d.fromCubicBezier(a.slice(3*h*3,3*h*3+12),b,1);g=g.concat(i)}return g},a.exports=d},284:function(a,b,c){function d(a,b,c){this.verts=a,this.vertsPerLine=b||2,this.verticallyClosed=!!c;var d=f.defaultMap([f.POSITION,f.NORMAL,f.TEXCOORD0]),e=this.verts.length/3,g=e/this.vertsPerLine;f.call(this,d,e,(g-1)*(this.vertsPerLine-1)*6),this.rebuild()}function e(a){for(var b=a[0],c=a[0],d=a[2],e=a[2],f=3;f<a.length;f+=3)b=b<a[f+0]?b:a[f+0],c=c>a[f+0]?c:a[f+0],d=d<a[f+2]?d:a[f+2],e=e>a[f+2]?e:a[f+2];return{minX:b,maxX:c,minY:d,maxY:e}}var f=c(14),g=c(9);d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.rebuild=function(){this.getAttributeBuffer(f.POSITION).set(this.verts);for(var a=[],b=[],c=[],d=this.verts.length/3,h=d/this.vertsPerLine,i=0;h-1>i;i++){for(var j=0;j<this.vertsPerLine-1;j++){var k=(i+0)*this.vertsPerLine+(j+0),l=(i+1)*this.vertsPerLine+(j+0),m=(i+1)*this.vertsPerLine+(j+1),n=(i+0)*this.vertsPerLine+(j+1);a.push(k,l,n,n,l,m),c=g.getTriangleNormal(this.verts[3*k+0],this.verts[3*k+1],this.verts[3*k+2],this.verts[3*l+0],this.verts[3*l+1],this.verts[3*l+2],this.verts[3*n+0],this.verts[3*n+1],this.verts[3*n+2]),b.push(c[0],c[1],c[2])}if(this.verticallyClosed){var k=(i+0)*this.vertsPerLine+0,l=(i+1)*this.vertsPerLine+0,n=(i+0)*this.vertsPerLine+1;c=g.getTriangleNormal(this.verts[3*k+0],this.verts[3*k+1],this.verts[3*k+2],this.verts[3*l+0],this.verts[3*l+1],this.verts[3*l+2],this.verts[3*n+0],this.verts[3*n+1],this.verts[3*n+2]),b.push(c[0],c[1],c[2])}else b.push(c[0],c[1],c[2])}i--;for(var j=0;j<this.vertsPerLine-1;j++){var k=(i+0)*this.vertsPerLine+(j+0),l=(i+1)*this.vertsPerLine+(j+0),n=(i+0)*this.vertsPerLine+(j+1);c=g.getTriangleNormal(this.verts[3*k+0],this.verts[3*k+1],this.verts[3*k+2],this.verts[3*l+0],this.verts[3*l+1],this.verts[3*l+2],this.verts[3*n+0],this.verts[3*n+1],this.verts[3*n+2]),b.push(c[0],c[1],c[2])}b.push(c[0],c[1],c[2]),this.getAttributeBuffer(f.NORMAL).set(b),this.getIndexBuffer().set(a);for(var o=[],p=e(this.verts),q=p.maxX-p.minX,r=p.maxY-p.minY,i=0;i<this.verts.length;i+=3){var s=(this.verts[i+0]-p.minX)/q,t=(this.verts[i+2]-p.minY)/r;o.push(s,t)}return this.getAttributeBuffer(f.TEXCOORD0).set(o),this},d.createFromHeightMap=function(a,b,c,e){b=b||1,c=c||1,e=e||1;for(var f=[],g=0;g<a.length;g++)for(var h=0;h<a[g].length;h++)f.push(h*b,a[g][h]*c,g*e);return new d(f,a[0].length)},d.createTessellatedFlat=function(a,b,c,e){for(var f=[],g=0;e>g;g++)for(var h=0;c>h;h++)f.push(h*a/c-.5*a,0,g*b/e-.5*b);return new d(f,c)},a.exports=d},285:function(a,b,c){function d(a,b){this.nSegments=a||5,this.radius=b||1;for(var c=[],d=2*Math.PI/a,f=0,g=0;f<this.nSegments;f++,g+=d)c.push(Math.cos(g)*this.radius,Math.sin(g)*this.radius,0);e.call(this,c,!0),this.rebuild()}var e=c(283);d.prototype=Object.create(e.prototype),a.exports=d},286:function(a,b,c){function d(){e.apply(this,arguments),this.type="TextComponent",this._font=null,this._entity=null}var e=c(20),f=c(216),g=c(287);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.type="TextComponent",d.prototype.attached=function(a){this._entity=a},d.prototype.detached=function(){this._entity.clearComponent("MeshDataComponent"),this._entity=null},d.prototype.setFont=function(a){return this._font=a,this},d.prototype.setText=function(a,b){this._entity.clearComponent("MeshDataComponent");var c=g.meshesForText(a,this._font,b)[0],d=new f(c);return this._entity.setComponent(d),this},a.exports=d},287:function(a,b,c){function d(a){var b=a.type;return void 0!==a.x2&&(b+=" "+a.x2),void 0!==a.y2&&(b+=" "+a.y2),void 0!==a.x1&&(b+=" "+a.x1),void 0!==a.y1&&(b+=" "+a.y1),void 0!==a.x&&(b+=" "+a.x),void 0!==a.y&&(b+=" "+a.y),b}function e(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",a);for(var d=c.getTotalLength(),e=[],f=0;d>f;f+=b){var g=c.getPointAtLength(f);e.push({x:g.x,y:g.y})}return e}function f(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))}function g(a,b){var c=[],d=[];d.push(a[0]);for(var e=1;e<a.length;e++){var g=a[e-1],h=a[e],i=f(g,h);i>b+.1&&(c.push(d),d=[]),d.push(h)}return c.push(d),c}function h(a){var b=[];b.push(a[0]);for(var c=1;c<a.length-1;c++){var d=a[c-1].x-a[c].x,e=a[c-1].y-a[c].y,f=a[c].x-a[c+1].x,g=a[c].y-a[c+1].y,h=Math.atan2(e,d),i=Math.atan2(g,f);Math.abs(h-i)>y&&b.push(a[c])}return b.push(a[c]),b}function i(a){for(var b=new t(a[0].x,a[0].y),c=b.clone(),d=1;d<a.length;d++){var e=a[d];e.x<b.x?b.x=e.x:e.x>c.x&&(c.x=e.x),e.y<b.y?b.y=e.y:e.y>c.y&&(c.y=e.y)}return{min:b,max:c}}function j(a,b){return a.min.x<b.min.x&&a.max.x>b.max.x&&a.min.y<b.min.y&&a.max.y>b.max.y}function k(a,b){return{min:new t(Math.min(a.min.x,b.min.x),Math.min(a.min.y,b.min.y)),max:new t(Math.max(a.max.x,b.max.x),Math.max(a.max.y,b.max.y))}}function l(a){for(var b=a.map(function(a){return{polygon:a,boundingVolume:i(a),parent:null,children:[]}}),c=b[0].boundingVolume,d=1;d<b.length;d++){var e=b[d];c=k(c,e.boundingVolume)}for(var d=0;d<b.length;d++)for(var f=b[d],g=0;g<b.length;g++){var h=b[g];j(f.boundingVolume,h.boundingVolume)&&(f.children.push(h),h.parent=f)}var l=b.filter(function(a){return!a.parent});return l.forEach(function(a){a.children.forEach(function(a){Array.prototype.push.apply(l,a.children)})}),{topLevel:l.map(function(a){return{polygon:a.polygon,holes:a.children}}),boundingVolume:c}}function m(a){for(var b=new Array(a.length),c=0;c<a.length;c+=3)b[c+0]=a[c+0],b[c+1]=a[c+2],b[c+2]=a[c+1];return b}function n(a){var b=0;a.forEach(function(a){a.forEach(function(a){a._index=b,b++})})}function o(a){var b=[];return a.forEach(function(a){b.push(a.getPoint(0)._index,a.getPoint(1)._index,a.getPoint(2)._index)}),b}function p(a){a.sort(function(a,b){return a._index-b._index});var b=[];return a.forEach(function(a){b.push(a.x,a.y,0)}),b}function q(a,b){var c=new poly2tri.SweepContext(a.slice(0));b.forEach(function(a){c.addHole(a.polygon.slice(0))}),c.triangulate();var d=c.getTriangles();return o(d)}function r(a,b){b=b||{},b.simplifyPaths=b.simplifyPaths!==!1;var c=a.getPath(0,0,b.fontSize),f=c.commands.map(d).reduce(function(a,b){return a+b},""),i=e(f,b.stepLength),j=g(i,b.stepLength);b.simplifyPaths&&(j=j.map(h)),n(j);var k=l(j),m=[];j.forEach(function(a){var b=p(a);Array.prototype.push.apply(m,b)});var o=[];return k.topLevel.forEach(function(a){var b=q(a.polygon,a.holes);Array.prototype.push.apply(o,b)}),{surfaceIndices:o,surfaceVerts:m,extrusions:j,boundingVolume:k.boundingVolume}}function s(a,b,c){function d(a,b,c,d){function e(){var e=new w(a.surfaceVerts,a.surfaceIndices),g=new u;g.translation.setDirect(b,c,-d.extrusion/2),g.scale.setDirect(1,-1,1),g.update(),f.addMeshData(e,g)}function g(){var e=new w(a.surfaceVerts,m(a.surfaceIndices)),g=new u;g.translation.setDirect(b,c,d.extrusion/2),g.scale.setDirect(1,-1,1),g.update(),f.addMeshData(e,g)}e(),g(),d.extrusion&&a.extrusions.forEach(function(a){var e=p(a);e.push(e[0],e[1],e[2]);var g=new x(e,!0),h=new x([0,0,-d.extrusion/2,0,0,d.extrusion/2]),i=g.mul(h),j=new u;j.translation.setDirect(b,c,0),j.scale.setDirect(1,-1,-1),j.update(),f.addMeshData(i,j)})}c=c||{},c.extrusion=void 0!==c.extrusion?c.extrusion:4,c.stepLength=c.stepLength||1,c.fontSize=c.fontSize||48;var e=[];b.forEachGlyph(a,0,0,c.fontSize,{},function(a,b,d){a.path.commands.length>0&&e.push({data:r(a,c),x:b,y:d})});var f=new v,g=e[0],h=g.data.boundingVolume.min.x,i=e[e.length-1],j=i.data.boundingVolume.max.x+i.x,k=(h+j)/2;return e.forEach(function(a){d(a.data,a.x-k,0,c)}),f.build()}var t=c(19),u=c(41),v=c(112),w=c(282),x=c(283),y=.001;a.exports={meshesForText:s}},288:function(a,b,c){function d(){e.apply(this,arguments),this._type="TextComponent"}var e=c(88),f=c(286),g=c(54);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,e._registerClass("text",d),d.prototype._create=function(){return new f},d.prototype._remove=function(a){a.clearComponent("TextComponent")},d.prototype.update=function(a,b,c){return e.prototype.update.call(this,a,b,c).then(function(a){return a?g.createPromise(function(c){opentype.load(b.font.fontRef,function(d,e){if(d)return console.error(d),void c(a);var f=1,g=function(a,b){return(.08*(1-b)+.01)*a};a.setFont(e),a.setText(b.text,{extrusion:b.extrusion,fontSize:f,stepLength:g(f,b.smoothness),simplifyPaths:!0}),c(a)})}):void 0})},a.exports=d},289:function(a,b,c){function d(a){this.verts=a;var b=e.defaultMap([e.POSITION,e.NORMAL]);e.call(this,b,3,3),this.rebuild()}var e=c(14),f=c(9);d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.rebuild=function(){this.getAttributeBuffer(e.POSITION).set(this.verts);var a=f.getTriangleNormal(this.verts[0],this.verts[1],this.verts[2],this.verts[3],this.verts[4],this.verts[5],this.verts[6],this.verts[7],this.verts[8]);return this.getAttributeBuffer(e.NORMAL).set([a[0],a[1],a[2],a[0],a[1],a[2],a[0],a[1],a[2]]),this.getIndexBuffer().set([0,1,2]),this},a.exports=d}});